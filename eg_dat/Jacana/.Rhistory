points(smooth.spline(numint~nind,nknots=4),col="red",type="l")
points(smooth.spline(numint~nind,nknots=3),col="red",type="l")
points(smooth.spline(numint~nind,nknots=5),col="red",type="l")
points(smooth.spline(numint~nind,nknots=2),col="red",type="l")
points(smooth.spline(numint~nind,nknots=1),col="red",type="l")
points(smooth.spline(numint~nind,nknots=6),col="red",type="l")
boxplot(numint~nind)
points(smooth.spline(numint~nind),col="red",type="l")
boxplot(numint~nind)
points(smooth.spline(numint~nind),col="red",type="l")
boxplot(numint~nind)
boxplot(numint~nind,xlim=c(0,6))
points(smooth.spline(numint~nind),col="red",type="l")
m1=lm(numint~nind)
m2=lm(numint~I(nind)^2)
anova(m1,m2)
m2=lm(numint~I(nind^2))
anova(m1,m2)
summary(m2)
m2=lm(numint~poly(nind,2))
summary(m2)
anova(m1,m2)
m3=lm(numint~poly(nind,3))
anova(m1,m2)
anova(m1,m3)
anova(m2,m3)
medagr=scan()
plot(numint~nind)
plot(magr~nind)
ls()
plot(medagr~nind)
boxplot(medagr~nind)
boxplot(numint~nind)
library(mgcv)
dados=read.csv("/Users/RMaia/Desktop/dominancia.csv")
dados
dados[dados$Grupo_ID==1&3&6]
dados[dados$Grupo_ID==1&3&6,]
dados[,dados$Grupo_ID==1&3&6]
dados[dados$Grupo_ID==c(1,3,6)]
dados[dados$Grupo_ID==c(1,3,6),]
dados[dados$Grupo_ID==1,]
dados[dados$Grupo_ID==3,]
dados[dados$Grupo_ID==6,]
dados[dados$Grupo_ID==1&3,]
dados[dados$Grupo_ID==1,][dados$Grupo_ID==3,]
dados[dados$Grupo_ID==1,]
dados[dados$Grupo_ID==1 & dados$Grupo_ID==3 & dados$Grupo_ID==6,]
dados[,c(1:9,28:26)]
dados[c(1:9,28:26),]
dados[c(1:9,28:36),]
dados[c(1:9,19:27,28:36),]
variados=dados[c(1:9,19:27,28:36),]
variados
names(variados)
with(variados,plot(n)interacao~Tempo)
with(variados,plot(n_interacao~Tempo)
)
with(variados,plot(n_interacao~Tempo,pch=Grupo_ID))
m1=gamm(n_interacao~s(Tempo)+s(testosterona)+n_individuos,random=~1|list(Grupo_ID),variados)
?gamm
m1=gamm(n_interacao~s(Tempo)+s(testosterona)+n_individuos,random=list(Grupo_ID=~1),variados)
m1=gamm(n_interacao~s(Tempo)+s(testosterona)+n_individuos,random=list(Grupo_ID=~1),data=variados)
m1=gamm(n_interacao~s(Tempo,k=9)+s(testosterona)+n_individuos,random=list(Grupo_ID=~1),data=variados)
summary(m1$gam)
plot(m1$gamm)
plot(m1$gam)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos),random=list(Grupo_ID=~1),data=variados)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=4),random=list(Grupo_ID=~1),data=variados)
plot(m1$gam)
summary(m1$gamm)
summary(m1$gam)
m0=gamm(n_interacao~s(Tempo,k=9),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
anova(m1$gam,m0$gam)
plot(m1$gam)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=2),random=list(Grupo_ID=~1),data=variados)
plot(m1$gam)
summary(m1$gam)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=8),random=list(Grupo_ID=~1),data=variados)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=5),random=list(Grupo_ID=~1),data=variados)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
summary(m1$gam)
m1=gamm(n_interacao~s(Tempo,k=9)+Tratamento+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
summary(m1$gam)
plot(m1$gam)
m0=gamm(n_interacao~s(Tempo,k=9)+Tratamento,random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
m1=gamm(n_interacao~s(Tempo,k=9)+Tratamento+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m0=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
m1=gamm(n_interacao.n_individuo~s(Tempo,k=9)+Tratamento+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m0=gamm(n_interacao.n_individuo~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
m0=gamm(n_interacao.n_individuo~s(Tempo,k=9)+Tratamento,random=list(Grupo_ID=~1),data=variados)
m1=gamm(n_interacao.n_individuo~s(Tempo,k=9)+Tratamento+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
summary(m1$gam)
m1=gamm(n_interacao.n_individuo~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m0=gamm(n_interacao.n_individuo~s(Tempo,k=9),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
summary(m1$gam)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m0=gamm(n_interacao~s(Tempo,k=9),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
plot(m1$gam)
?plot.gam
plot(m1$gam,residuals=T)
plot(m1$gam,residuals=T,all.terms=T)
plot(m1$gam,residuals=T,all.terms=T,seWithMean=T)
plot(m1$gam,residuals=T,all.terms=T,seWithMean=T,shadow=T)
plot(m1$gam,residuals=T,all.terms=T,seWithMean=T,shade=T)
plot(m1$gam,residuals=T,all.terms=T,seWithMean=T,shade=T,pch=16)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=3)-1,random=list(Grupo_ID=~1),data=variados)
plot(m1$gam,residuals=T,all.terms=T,seWithMean=T,shade=T,pch=16)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
plot(m1$gam,residuals=T,all.terms=T,seWithMean=T,shade=T,pch=16)
m1=gamm(n_interacao.n_individuos~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m1=gamm(n_interacao.n_individuo~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
plot(m1$gam,residuals=T,all.terms=T,seWithMean=T,shade=T,pch=16)
summary(m1$gam)
dados<-read.table("/Users/RMaia/Documents/Artigos/! Em Desenvolvimento/Robs-Luiza/Roberto.txt",h=T)#
dados$Id<-as.factor(dados$Id)#
dados$Grupo_Id<-as.factor(dados$Grupo_Id)#
dados$Tratamento<-as.factor(dados$Tratamento)#
dados$logtest<-log(dados$Testosterona)#
#
dados.int<-read.csv("/Users/RMaia/Documents/Artigos/! Em Desenvolvimento/Robs-Luiza/dominancia.csv")#
dados.int$Tratamento<-as.factor(dados.int$Tratamento)#
dados.int$Grupo_ID<-as.factor(dados.int$Grupo_ID)#
#
m1<-gamm(Testosterona~s(Tempo,by=Tratamento,k=9)+Tratamento,random=list(Id=~1),data=dados)#
 m2<-gamm(Testosterona~s(Tempo,k=9)+Tratamento,random=list(Id=~1),data=dados)#
m3<-gamm(Testosterona~s(Tempo,k=9),random=list(Id=~1),data=dados)#
m4<-gamm(Testosterona~Tratamento,random=list(Id=~1),data=dados)
plot(m1$gam,rug=F,shade=T,select=1,ylab="",xlab="",xaxt="n",yaxt="n",ylim=c(-0.35,0.35))
plot(m1$gam,rug=F,shade=T,select=1,ylab="",xlab="",xaxt="n",yaxt="n",ylim=c(-0.35,0.35),residuals=T)
plot(m1$gam,shade=T,select=1,residuals=T)
plot(m1$gam,shade=T,select=1,residuals=T,pch=16)
plot(m1$gam,shade=T,select=1,residuals=T,pch=16,jitter=T)
?plot.gam
plot(m1$gam,shade=T,select=1,residuals=T,pch=16,jit=T)
plot(m1$gam,shade=T,select=1,residuals=T,pch=16,jit=T,rug=F)
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F)
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F,seWithMean=T)
m1<-gamm(Testosterona~s(Tempo,by=Tratamento,k=9)+Tratamento-1,random=list(Id=~1),data=dados)
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F,seWithMean=T)
m1<-gamm(Testosterona~s(Tempo,by=Tratamento,k=9)+Tratamento,random=list(Id=~1),data=dados)
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F,seWithMean=T,which=1)
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F,seWithMean=T,select=1)
points(scale(dados$Testosterona,scale=F)~dados$Tempo)
points(scale(dados$Testosterona[dados$Tratamento==0],scale=F)~dados$Tempo)
points(scale(dados$Testosterona[dados$Tratamento==0,],scale=F)~dados$Tempo)
points(scale(dados$Testosterona[dados$Tratamento==0],scale=F)~dados$Tempo[dados$Tratamento==0])
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F,seWithMean=T,select=1)
points(scale(dados$Testosterona[dados$Tratamento==0],scale=F)~dados$Tempo[dados$Tratamento==0])
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F,seWithMean=T,select=2)
points(scale(dados$Testosterona[dados$Tratamento==1],scale=F)~dados$Tempo[dados$Tratamento==1])
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F,seWithMean=T,select=3)
points(scale(dados$Testosterona[dados$Tratamento==2],scale=F)~dados$Tempo[dados$Tratamento==2])
points(scale(dados$Testosterona[dados$Tratamento==2],scale=F)~dados$Tempo[dados$Tratamento==2],jitter=0.5)
?jitter
points(scale(dados$Testosterona[dados$Tratamento==2],scale=F)~jitter(dados$Tempo[dados$Tratamento==2]))
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F,seWithMean=T,select=3)
points(scale(dados$Testosterona[dados$Tratamento==2],scale=F)~jitter(dados$Tempo[dados$Tratamento==2]))
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F,seWithMean=T,select=1)
points(scale(dados$Testosterona[dados$Tratamento==0],scale=F)~jitter(dados$Tempo[dados$Tratamento==0]))
m1=gamm(n_interacao.n_individuo~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
plot(m1$gam,shade=T,residuals=T,pch=16,jit=T,rug=F,seWithMean=T,select=2)
plot(m1$gam,shade=T,residuals=F,rug=F,seWithMean=T,select=2)
points(scale(variados$n_interacao.n_individuo,scale=F)~jitter(variados$n_individuos))
points(scale(variados$n_interacao.n_individuo,scale=F)~jitter(variados$n_individuos,factor=0.5))
plot(m1$gam,shade=T,residuals=F,rug=F,seWithMean=T,select=2)
points(scale(variados$n_interacao.n_individuo,scale=F)~jitter(variados$n_individuos,factor=0.5))
m1=gamm(n_interacao.n_individuo~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m0=gamm(n_interacao.n_individuo~s(Tempo,k=9),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
m1=gamm(n_interacao.n_individuo~s(Tempo,k=9, by=Tratamento)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
summary(m1)
summary(m1$gam)
plot(m1$gam)
summary(m1$lme)
m0=gamm(n_interacao.n_individuo~s(Tempo,k=9,by=Tratamento),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
plot(m0$gam)
m1=gamm(n_interacao~s(Tempo,k=9, by=Tratamento)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m0=gamm(n_interacao~s(Tempo,k=9,by=Tratamento),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m0$lme)
plot(m1$gam)
m1=gamm(n_interacao~s(Tempo,k=9, by=Tratamento)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m0.1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
anova(m1,m0.1)
anova(m1$lme,m0.1$lme)
?s
summary(m1$gam)
ma<-gamm(Testosterona~s(Tempo,by=Tratamento,k=9)+Tratamento-1,random=list(Id=~1),data=dados)
summary(ma$gam)
m1=gamm(n_interacao.n_individuo~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m0=gamm(n_interacao.n_individuo~s(Tempo,k=9),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m2$lme)
anova(m1$lme,m0$lme)
m1$lme
m0$lme
m1=gamm(n_interacao.n_individuo~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m0=gamm(n_interacao.n_individuo~s(Tempo,k=9),random=list(Grupo_ID=~1),data=variados)
anova(m1$gam,m2$gam)
anova(m1$lme,m2$lme)
anova(m1$lme,m0$lme)
m1$gam
m0$gam
pchisq(0.72,2)
pchisq(0.72,1)
pchisq(0.7203985,1)
pchisq(0.7203985,0)
pchisq(0.7203985,3)
m1=gamm(n_interacao~s(Tempo,k=9)+s(n_individuos,k=3),random=list(Grupo_ID=~1),data=variados)
m0=gamm(n_interacao~s(Tempo,k=9),random=list(Grupo_ID=~1),data=variados)
anova(m1$lme,m2$lme)
anova(m1$lme,m0$lme)
qchisq(3.59,1)
pchisq(3.59,1)
pchisq(3.59,2)
pchisq(3.59,5)
pchisq(3.59,7)
pchisq(0.72,7)
pchisq(0.63,7)
pchisq(6.82,1)
1-pchisq(6.82,1)
1-pchisq(3.58,1)
1-pchisq(3.59,1)
1-pchisq(3.59,7)
1-pchisq(3.59,2)
1-pchisq(0.69,2)
1-pchisq(0.72,2)
gather.spectra<-function(where,decimal=".")#
{#
final<-data.frame(wl=300:700)#
#
oldwd<-getwd()#
#
setwd(where)#
#
files<-list.files(pattern=".ttt$")#
#
#
for(i in files)#
{#
	#
dados<-read.table(i, dec=decimal, sep=";", skip=7, nrows=401)#
names(dados)<-c("wavelength",i)#
#
interp<-approx(dados[,1], dados[,2], xout=300:700)$y#
#
interp<-as.data.frame(interp)#
#
names(interp)<-i#
names(interp)<-strsplit(names(interp),".ttt")#
#
#SOMAR MINIMO SE FOR MENOR QUE ZERO#
if(min(interp) < 0) {interp<-interp + abs(min(interp))}#
#
final<-data.frame(final, interp)#
}#
#
setwd(oldwd)#
#
final#
}#
#
#
#
#
mean.spectra<-function(gatherspectra,BY)#
{#
dup<-seq(2,length(names(gatherspectra)),by=BY)#
#
samplenames<-names(gatherspectra[dup])#
#
avgZ.i<-NULL#
avgZ<-NULL#
#
for(i in dup)#
	{#
	#
	avgZ.i<-apply(gatherspectra[i:(i+BY-1)],1,mean)#
	avgZ<-cbind(avgZ,avgZ.i)#
	#
	}#
#
avgZ<-data.frame(avgZ)#
names(avgZ)<-samplenames#
avgZ#
}
jacana=gather.spectra("/Users/RMaia/Desktop/JacanaJacana")
jacana=gather.spectra("/Users/RMaia/Desktop/JacanaJacana",decimal=",")
aratinga=gather.spectra("/Users/RMaia/Desktop/AratingaAurea",decimal=",")
thraupis=gather.spectra("/Users/RMaia/Desktop/ThraupisSayaca",decimal=",")
jacana=mean.spectra(jacana,3)
aratinga=mean.spectra(aratinga,3)
thraupis=mean.spectra(thraupis,3)
length(jacana)
length(aratinga)
length(thraupis)
par(mfrow=c(33,))
par(mfrow=c(3,3))
names(jacana)
for(i in 1:9) {plot(jacana[i]~c(300:700))}
for(i in 1:9) {plot(jacana[i,]~c(300:700))}
for(i in 1:9) {plot(jacana[,i]~c(300:700))}
par(mfrow=c(4,4))
for(i in 1:13) {plot(aratinga[,i]~c(300:700))}
par(mfrow=c(4,5))
for(i in 1:13) {plot(thraupis[,i]~c(300:700))}
par(mfrow=c(4,4))
for(i in 1:13) {plot(thraupis[,i]~c(300:700))}
write.csv(jacana,"/Users/RMaia/Desktop/jacana.csv")
write.csv(aratinga,"/Users/RMaia/Desktop/aratinga.csv")
write.csv(thraupis,"/Users/RMaia/Desktop/thraupis.csv")
